package com.sascom.chickenstock.account.domain; import jakarta.persistence.*; import lombok.*; @Entity @Table(name="margin_ledger", uniqueConstraints=@UniqueConstraint(columnNames={{"accountId","companyId"}})) @Getter @Setter @NoArgsConstructor public class MarginLedger { @Id @GeneratedValue(strategy=GenerationType.IDENTITY) private Long id; private Long accountId; private Long companyId; private Long borrowedTotal=0L; public static MarginLedger of(Long accountId, Long companyId){ MarginLedger m=new MarginLedger(); m.accountId=accountId; m.companyId=companyId; return m; } public void addBorrowed(long a){ borrowedTotal+=a; } public long consumeBorrowed(long a){ long c=Math.min(borrowedTotal,a); borrowedTotal-=c; return c; } }